FROM python:3.9-slim

WORKDIR /app

COPY FastAPI/requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY FastAPI/ .

# Download model file if it doesn't exist
RUN apt-get update && apt-get install -y wget && \
    if [ ! -f xgboost_fare_model.pkl ]; then \
        wget -O xgboost_fare_model.pkl https://storage.googleapis.com/uber-simulation-models/xgboost_fare_model.pkl; \
    fi

EXPOSE 8000

CMD ["uvicorn", "predict_API:app", "--host", "0.0.0.0", "--port", "8000"]